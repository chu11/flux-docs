
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/example_job_submit_api.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_example_job_submit_api.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_example_job_submit_api.py:


Introductory example - Job Submit API
=====================================

This example will show how to submit a job
using the Flux Python bindings.

.. GENERATED FROM PYTHON SOURCE LINES 9-15

.. code-block:: default



    import os
    import flux
    from flux.job import JobspecV1








.. GENERATED FROM PYTHON SOURCE LINES 16-19

Here we instantiate a flux handle. This will connect to the running flux instance.
If you were running this on a cluster with Flux, you'd likely already be able to
connect. If you are testing out on your own, you might need to do flux start --test-size=4

.. GENERATED FROM PYTHON SOURCE LINES 19-21

.. code-block:: default

    handle = flux.Flux()








.. GENERATED FROM PYTHON SOURCE LINES 22-26

This is a new jobspec, or a recipe for a flux job. You'll notice we are providing a command
directly, along with tasks, nodes, and cores per task. You could also provide a script here.
If we were doing this on the command line, it would be equivalent to what is generated by:
flux submit --ntasks=4 --nodes=2 --cores-per-task=2 sleep 10

.. GENERATED FROM PYTHON SOURCE LINES 26-30

.. code-block:: default

    jobspec = JobspecV1.from_command(
        command=["sleep", "10"], num_tasks=4, num_nodes=2, cores_per_task=2
    )








.. GENERATED FROM PYTHON SOURCE LINES 31-32

This is how we set the "current working directory" (cwd) for the job

.. GENERATED FROM PYTHON SOURCE LINES 32-34

.. code-block:: default

    jobspec.cwd = os.getcwd()








.. GENERATED FROM PYTHON SOURCE LINES 35-36

This is how we set the job environment

.. GENERATED FROM PYTHON SOURCE LINES 36-38

.. code-block:: default

    jobspec.environment = dict(os.environ)








.. GENERATED FROM PYTHON SOURCE LINES 39-40

Let's submit the job! We will get the job id.

.. GENERATED FROM PYTHON SOURCE LINES 40-43

.. code-block:: default

    print(flux.job.submit(handle, jobspec))






.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ƒ2G8ZaFZ




.. GENERATED FROM PYTHON SOURCE LINES 44-46

This could have easily been a script, e.g., ./compute.py 120
You can continue submitting jobs to your same handle, even the same job.

.. GENERATED FROM PYTHON SOURCE LINES 46-47

.. code-block:: default

    print(flux.job.submit(handle, jobspec))




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ƒ2GsZDRZ





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.232 seconds)


.. _sphx_glr_download_auto_examples_example_job_submit_api.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: example_job_submit_api.py <example_job_submit_api.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: example_job_submit_api.ipynb <example_job_submit_api.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
